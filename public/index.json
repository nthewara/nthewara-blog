
[{"content":"","date":"2025-08-31","externalUrl":null,"permalink":"/","section":"","summary":"","title":"","type":"page"},{"content":" Introduction # This blog post shares an engineering validated pattern for establishing connectivity between Azure Extended Zones and Azure Virtual WAN environments. Currently, Virtual WAN hubs cannot be deployed within Extended Zones, so we need alternative approaches to bridge these environments.\nBelow is a summary of connectivity options between Extended Zones and Azure regions:\nConnectivity Options for Extended Zone to Azure Region # Connectivity Method Hub-Spoke Environment Virtual WAN Environment Global VNET Peering Recommended option for connecting Hub-Spoke network hubs Not supported when hosting a gateway in Extended Zone VNET SD-WAN Network Virtual Appliance Establish connectivity using SD-WAN tunnels Establish connectivity using SD-WAN tunnels ExpressRoute Not recommended due to added latency and bandwidth constraints Recommended option given current lack of Virtual WAN hub support in Extended Zones For this implementation, we\u0026rsquo;ll use ExpressRoute to connect the Extended Zone environment to other Azure regions.\nConfiguration # This setup follows the same configuration pattern used for establishing coexistence between Hub-Spoke environments and Virtual WAN. The key requirement is enabling bidirectional traffic flow between the two gateway types.\nEssential Configuration Settings:\nHub-Spoke ExpressRoute Gateway: Enable \u0026ldquo;Allow traffic from remote Virtual WAN networks\u0026rdquo; Virtual WAN ExpressRoute Gateway: Enable \u0026ldquo;Allow traffic from non Virtual WAN networks\u0026rdquo; Below is my ExpressRoute Gateway deployed to Extended Zone VNET. Below configuration enables ExpressRoute Gateway to recieve routes from Virtual WAN ExpressRoute Gateway Validating Connectivity # Step 1: Verify Extended Zone VM Routes # First, validate that VMs in the Extended Zone are learning routes from the Virtual WAN environment through the ExpressRoute Gateway.\nEffective routes from my VM in Perth Extended Zone shows routes learned from ExpressRoute Gateway and these are remote routes from my Virtual WAN environment.\nStep 2: Validate Virtual WAN Environment Routes # Next, verify that VMs connected to the Virtual WAN hub are learning Extended Zone VNET prefixes.\nBelow routes are learned by my virtual machine connected to Virtual WAN hub that is hosting ExpressRoute Gateway and we are able to see Extended Zone VNET prefixes are learned by the network interface attached to my VM.\nStep 3: Check Virtual WAN Hub Effective Routes # For deeper insight into routing behavior, examine the effective routes from the Virtual WAN Hub. This view helps understand:\nAS Path information All prefixes learned by the ExpressRoute Gateway Route propagation between environments Additional Considerations # Bandwidth Constraints: ExpressRoute Gateway bandwidth is limited by the gateway SKU configuration\nAdditional Latency: The gateway hop introduces extra latency to traffic flows between environments\nConclusion # If you are already using Virtual WAN network deployment, you can now take full advantage of Extended Zones by connecting to your existing Virtual WAN environment using your current ExpressRoute connectivity.\n","date":"2025-08-31","externalUrl":null,"permalink":"/posts/azureextendedzonevwan/","section":"Posts","summary":"","title":"Azure Extended Zone Connectivity to Virtual WAN","type":"posts"},{"content":"","date":"2025-08-31","externalUrl":null,"permalink":"/posts/","section":"Posts","summary":"","title":"Posts","type":"posts"},{"content":" Introduction # Migrating from a traditional hub-and-spoke Virtual Network (VNET) architecture to Azure Virtual WAN can seem complex \u0026amp; challenging, but establishing coexistence between both environments during the transition makes the process smoother and reduces risk. This post walks you through the most efficient approach for maintaining connectivity during your migration.\nWhen planning your Virtual WAN migration, you have several connectivity options to bridge your existing and new environments\nUtilise ExpressRoute Circuit Utilise Site to Site VPN Connectivity using VPN Gateways Utilise SD-WAN Connectivity using SD-WAN NVAs Utilise On-premises traffic routing Recommended Approach: If your existing environment already uses ExpressRoute, this is the most straightforward and cost-efficient coexistence strategy. However, recent Azure changes require specific configuration steps to ensure proper route propagation between environments. I have detailed below, configuration required to make this scenario work in your environment.\nStep 01 -\u0026gt; Enable \u0026ldquo;Allow traffic from remote Virtual Networks\u0026rdquo; in your existing Traditional Hub Spoke ExpressRoute Gateway # This option allows Virtual WAN routes to be propagated to existing traditional hub spoke environment. Without this, routes wont be learned and this option is not enabled by default. Step 02 -\u0026gt; Enable \u0026ldquo;Allow traffic from non Virtual WAN networks\u0026rdquo; in your Virtual WAN Hub # This options allows routes learned by tranditional hub spoke environment to be propagated to Virtual WAN Hubs. This option is also disabled by default. Step 03 -\u0026gt; Connect existing ExpressRoute Circuit to Virtual WAN Hub # This establishment allows routes to be exchanged between existing hub spoke environment and new virtual wan environment\nOnce we have established connectivity, next we can validate route exchange between existing and new environments\nStep 04 - Verify Virtual WAN effective Routes # Effective routes show us learned routes and we can see routes learned via 12076 AS Path. These are routes learned from remote traditional hub spoke environment\nStep 05 - Verify Traditional Hub Spoke Environment # To verify traditional Hub Spoke environment, we will utilise powershell and list learned routes on the ExpressRoute Gateway\n$rg = \u0026#39;ntvwanmig-fvvw\u0026#39; $gw = \u0026#39;ntvwanmig-ergw-fvvw\u0026#39; Get-AzVirtualNetworkGatewayLearnedRoute ` -ResourceGroupName $rg ` -VirtualNetworkGatewayName $gw Below is the output from traditional Hub Spoke ExpressRoute Gateway. This is demonstrating gateway learning routes from Virtual WAN environment via existing ExpressRoute Circuit and using AS Path 12076. We can also verify routes learned by the ExpressRoute Circuit using below command\n$rg = \u0026#39;ntvwanmig-fvvw\u0026#39; $erc = \u0026#39;ntvwanmig-er-circuit-fvvw\u0026#39; Get-AzExpressRouteCircuitRouteTable -ResourceGroupName $rg ` -ExpressRouteCircuitName $erc ` -PeeringType \u0026#34;AzurePrivatePeering\u0026#34; ` -DevicePath \u0026#34;Primary\u0026#34; Below output confirms routes learned via traditional Hub Spoke ER Gateway and Virtual WAN Hub ER gateway. Note that these routes are all learned via AS 65515 which is assigned to each of the gateways in vWAN and Hub Spoken environment. VMs from existing environment can now reach new Virtual WAN environment I have also created a video demonstrating this scenario below Key Takeaways # Planning is crucial: Understand your connectivity options before beginning migration Configuration order matters: Follow the steps in sequence for successful coexistence Verification is essential: Use both Azure portal and PowerShell to confirm proper route propagation ExpressRoute is optimal: If already in use, ExpressRoute provides the most cost-effective coexistence solution Conclusion # Establishing coexistence between traditional hub-and-spoke and Virtual WAN environments doesn\u0026rsquo;t have to be complex. By following these configuration steps and properly verifying route propagation, you can ensure smooth connectivity during your migration process. This approach minimises downtime and reduces the risk associated with large-scale network changes.\n","date":"2025-07-25","externalUrl":null,"permalink":"/posts/vwanhubspokemigration/","section":"Posts","summary":"","title":"Migrate from Hub-Spoke to Azure Virtual WAN ExpressRoute Coexistence Guide","type":"posts"},{"content":" Coming Soon # ","externalUrl":null,"permalink":"/about/","section":"","summary":"","title":"About Me","type":"page"},{"content":"","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":" Coming Soon # ","externalUrl":null,"permalink":"/resources/","section":"","summary":"","title":"Resources","type":"page"},{"content":"","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"},{"content":"","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"}]